import{c as I,a as J,u as V,r as o,R as e,b as C,L as r,B as x}from"./index-C8OgQ19d.js";import{a as Y}from"./useApi-CDCt5oBc.js";const O=()=>{const{userId:i}=I(),v=J(),{user:l,isAuthenticated:D,getAuthHeader:h}=V(),[n,u]=o.useState("posts"),[m,M]=o.useState(null),[g,P]=o.useState([]),[y,S]=o.useState([]),[N,L]=o.useState([]),[U,w]=o.useState(!0),[T,A]=o.useState(null),{drafts:b,loading:R}=Y(l==null?void 0:l.id),c=m&&l&&m.id===l.id;o.useEffect(()=>{i&&(async()=>{try{w(!0);const a=await fetch(`http://localhost:3001/api/users/${i}`);if(!a.ok)throw new Error("User not found");const d=await a.json();M(d.data);const s=await fetch(`http://localhost:3001/api/users/${i}/posts`);if(s.ok){const p=await s.json();P(p.data||[])}if(D&&((l==null?void 0:l.id)===parseInt(i)||(l==null?void 0:l.id)===i))try{const p=await fetch("http://localhost:3001/api/communities/my",{headers:{"Content-Type":"application/json",...h()}});if(p.ok){const f=await p.json();S(f.data||f.communities||[])}const _=await fetch("http://localhost:3001/api/sub-clubs/my",{headers:{"Content-Type":"application/json",...h()}});if(_.ok){const f=await _.json();L(f.data||f.subClubs||[])}}catch(p){console.error("Error fetching user communities:",p)}}catch(a){A(a.message)}finally{w(!1)}})()},[i]);const E=t=>{const a=new Date(t),s=Math.floor((new Date-a)/(1e3*60*60*24));return s===0?"Today":s===1?"Yesterday":s<30?`${s} days ago`:s<365?`${Math.floor(s/30)} months ago`:`${Math.floor(s/365)} years ago`},k=(t,a=120)=>t.length<=a?t:t.substr(0,a)+"...",z=async t=>{try{(await fetch(`http://localhost:3001/api/posts/${t}/publish`,{method:"PUT",headers:{"Content-Type":"application/json"}})).ok?(x.success("Draft published successfully!"),window.location.reload()):x.error("Failed to publish draft")}catch{x.error("Error publishing draft")}},B=async t=>{if(window.confirm("Are you sure you want to delete this draft?"))try{(await fetch(`http://localhost:3001/api/posts/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok?(x.success("Draft deleted successfully!"),window.location.reload()):x.error("Failed to delete draft")}catch{x.error("Error deleting draft")}};if(U)return e.createElement("div",{className:"min-h-screen pt-20 flex items-center justify-center"},e.createElement(C,{size:"lg",text:"Loading profile..."}));if(T||!m)return e.createElement("div",{className:"min-h-screen pt-20 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-4"},"User not found"),e.createElement("p",{className:"text-gray-600 mb-6"},"The user you're looking for doesn't exist."),e.createElement("button",{onClick:()=>v("/"),className:"btn-primary px-6 py-2"},"Go Home")));const j=g.length,F=g.reduce((t,a)=>t+(a.upvotes||0),0),H=g.reduce((t,a)=>t+(a.comment_count||0),0),$=E(m.created_at);return e.createElement("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-100"},e.createElement("nav",{className:"fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-xl border-b border-white/20"},e.createElement("div",{className:"max-w-6xl mx-auto px-4 py-3"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("button",{onClick:()=>v(-1),className:"flex items-center space-x-2 px-4 py-2 rounded-full bg-gradient-to-r from-purple-400/20 to-blue-400/20 hover:scale-105 transition-all duration-200"},e.createElement("span",null,"←"),e.createElement("span",{className:"font-medium text-gray-900"},"Back")),e.createElement("h1",{className:"text-xl font-bold text-gray-900"},m.username,"'s Profile"),e.createElement("div",{className:"w-20"})," "))),e.createElement("main",{className:"pt-20 pb-24 px-4 max-w-6xl mx-auto"},e.createElement("div",{className:"glass-card rounded-2xl p-6 mb-8 animate-glass-fade-in"},e.createElement("div",{className:"flex items-start space-x-6"},e.createElement("div",{className:"w-24 h-24 rounded-full bg-gradient-to-r from-purple-400 to-blue-400 flex items-center justify-center text-white font-bold text-3xl"},m.username[0].toUpperCase()),e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-center space-x-3 mb-2"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},m.username),m.username==="admin"&&e.createElement("span",{className:"px-3 py-1 bg-gradient-to-r from-gold-400 to-yellow-500 text-white text-sm rounded-full"},"Admin")),e.createElement("p",{className:"text-gray-600 mb-4"},"Joined ",$," • ",m.email),e.createElement("div",{className:`grid gap-4 ${c?"grid-cols-5":"grid-cols-3"}`},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"text-2xl font-bold text-gray-900"},j),e.createElement("div",{className:"text-sm text-gray-600"},"Posts")),e.createElement("div",{className:"text-center"},e.createElement("div",{className:"text-2xl font-bold text-gray-900"},F),e.createElement("div",{className:"text-sm text-gray-600"},"Upvotes")),e.createElement("div",{className:"text-center"},e.createElement("div",{className:"text-2xl font-bold text-gray-900"},H),e.createElement("div",{className:"text-sm text-gray-600"},"Comments")),c&&e.createElement(e.Fragment,null,e.createElement("div",{className:"text-center"},e.createElement("div",{className:"text-2xl font-bold text-gray-900"},y.length),e.createElement("div",{className:"text-sm text-gray-600"},"Communities")),e.createElement("div",{className:"text-center"},e.createElement("div",{className:"text-2xl font-bold text-gray-900"},N.length),e.createElement("div",{className:"text-sm text-gray-600"},"Sub-Clubs"))))),e.createElement("div",{className:"flex flex-col space-y-2"},c?e.createElement(e.Fragment,null,e.createElement(r,{to:"/create-post",className:"btn-primary px-6 py-2"},"✨ Create Post"),e.createElement("button",{className:"btn-secondary px-6 py-2"},"⚙️ Edit Profile")):e.createElement(e.Fragment,null,e.createElement("button",{className:"btn-primary px-6 py-2"},"👤 Follow"),e.createElement("button",{className:"btn-secondary px-6 py-2"},"💬 Message"))))),e.createElement("div",{className:"glass-card rounded-2xl p-6 mb-8"},e.createElement("div",{className:"flex space-x-8"},e.createElement("button",{onClick:()=>u("posts"),className:`pb-2 font-medium transition-colors duration-200 ${n==="posts"?"text-purple-600 border-b-2 border-purple-600":"text-gray-600 hover:text-gray-900"}`},"📝 Posts (",j,")"),c&&e.createElement("button",{onClick:()=>u("drafts"),className:`pb-2 font-medium transition-colors duration-200 ${n==="drafts"?"text-purple-600 border-b-2 border-purple-600":"text-gray-600 hover:text-gray-900"}`},"📄 Drafts (",b.length,")"),c&&e.createElement("button",{onClick:()=>u("communities"),className:`pb-2 font-medium transition-colors duration-200 ${n==="communities"?"text-purple-600 border-b-2 border-purple-600":"text-gray-600 hover:text-gray-900"}`},"🏘️ Communities (",y.length,")"),c&&e.createElement("button",{onClick:()=>u("subclubs"),className:`pb-2 font-medium transition-colors duration-200 ${n==="subclubs"?"text-purple-600 border-b-2 border-purple-600":"text-gray-600 hover:text-gray-900"}`},"🎯 Sub-Clubs (",N.length,")"),e.createElement("button",{onClick:()=>u("activity"),className:`pb-2 font-medium transition-colors duration-200 ${n==="activity"?"text-purple-600 border-b-2 border-purple-600":"text-gray-600 hover:text-gray-900"}`},"📊 Activity"))),e.createElement("div",{className:"space-y-6"},n==="posts"&&e.createElement("div",{className:"space-y-4"},g.length>0?g.map((t,a)=>e.createElement("div",{key:t.id,className:"glass-card rounded-xl p-6 animate-slide-up",style:{animationDelay:`${a*.1}s`}},e.createElement("div",{className:"flex items-start justify-between"},e.createElement("div",{className:"flex-1"},e.createElement(r,{to:`/post/${t.id}`,className:"group"},e.createElement("h3",{className:"text-xl font-semibold text-gray-900 mb-2 group-hover:text-purple-600 transition-colors"},t.title),e.createElement("p",{className:"text-gray-600 mb-3 line-clamp-3"},k(t.content))),e.createElement("div",{className:"flex items-center space-x-6 text-sm text-gray-600"},e.createElement("span",{className:"flex items-center"},e.createElement("span",{className:"mr-1"},"↑"),(t.upvotes||0)-(t.downvotes||0)," votes"),e.createElement("span",{className:"flex items-center"},e.createElement("span",{className:"mr-1"},"💬"),t.comment_count||0," comments"),e.createElement("span",{className:"flex items-center"},e.createElement("span",{className:"mr-1"},"🔗"),t.share_count||0," shares"),e.createElement("span",null,E(t.created_at)))),c&&e.createElement("div",{className:"flex space-x-2"},e.createElement(r,{to:`/edit-post/${t.id}`,className:"text-gray-400 hover:text-purple-600 transition-colors"},"✏️"))))):e.createElement("div",{className:"glass-card rounded-xl p-8 text-center"},e.createElement("p",{className:"text-gray-500 mb-4"},c?"You haven't created any posts yet.":"This user hasn't created any posts yet."),c&&e.createElement(r,{to:"/create-post",className:"btn-primary px-6 py-2"},"Create your first post"))),n==="drafts"&&c&&e.createElement("div",{className:"space-y-4"},R?e.createElement("div",{className:"glass-card rounded-xl p-8 text-center"},e.createElement(C,{size:"md",text:"Loading drafts..."})):b.length>0?b.map((t,a)=>e.createElement("div",{key:t.id,className:"glass-card rounded-xl p-6 animate-slide-up",style:{animationDelay:`${a*.1}s`}},e.createElement("div",{className:"flex items-start justify-between"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-center space-x-2 mb-2"},e.createElement("h3",{className:"text-xl font-semibold text-gray-900"},t.title),e.createElement("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded"},"Draft")),e.createElement("p",{className:"text-gray-600 mb-3 line-clamp-3"},k(t.content)),e.createElement("div",{className:"text-sm text-gray-600"},"Last edited ",E(t.updated_at))),e.createElement("div",{className:"flex space-x-2"},e.createElement(r,{to:`/edit-post/${t.id}`,className:"btn-secondary px-4 py-2 text-sm"},"Edit"),e.createElement("button",{onClick:()=>z(t.id),className:"btn-primary px-4 py-2 text-sm"},"Publish"),e.createElement("button",{onClick:()=>B(t.id),className:"text-red-600 hover:text-red-800 px-2"},"🗑️"))))):e.createElement("div",{className:"glass-card rounded-xl p-8 text-center"},e.createElement("p",{className:"text-gray-500 mb-4"},"You don't have any drafts yet."),e.createElement(r,{to:"/create-post",className:"btn-primary px-6 py-2"},"Create a draft"))),n==="communities"&&e.createElement("div",{className:"space-y-4"},y.length>0?e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},y.map((t,a)=>e.createElement("div",{key:t.id,className:"glass-card rounded-xl p-6 animate-slide-up hover:shadow-lg transition-shadow",style:{animationDelay:`${a*.1}s`}},e.createElement("div",{className:"flex items-start justify-between mb-4"},e.createElement("div",{className:"flex-1"},e.createElement(r,{to:`/communities/${t.id}`,className:"text-xl font-semibold text-gray-900 hover:text-purple-600 transition-colors"},t.name),e.createElement("div",{className:"flex items-center space-x-2 mt-2"},e.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.role==="creator"?"bg-purple-100 text-purple-800":t.role==="moderator"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`},t.role==="creator"?"👑 Creator":t.role==="moderator"?"🛡️ Moderator":"👤 Member"),e.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.type==="location_bound"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`},t.type==="location_bound"?"📍 Location-bound":"🌐 Global")))),t.description&&e.createElement("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2"},t.description),e.createElement("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3"},e.createElement("span",null,"👥 ",t.actual_member_count||t.member_count||0," members"),t.location&&e.createElement("span",null,"📍 ",t.location)),t.tags&&t.tags.length>0&&e.createElement("div",{className:"flex flex-wrap gap-1 mb-3"},t.tags.slice(0,3).map((d,s)=>e.createElement("span",{key:s,className:"px-2 py-1 bg-gray-100 text-gray-600 rounded text-xs"},"#",d)),t.tags.length>3&&e.createElement("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded text-xs"},"+",t.tags.length-3)),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("span",{className:"text-xs text-gray-400"},"Joined ",E(t.joined_at||t.user_joined_at)),e.createElement(r,{to:`/communities/${t.id}`,className:"text-purple-600 hover:text-purple-800 text-sm font-medium"},"View →"))))):e.createElement("div",{className:"glass-card rounded-xl p-8 text-center"},e.createElement("div",{className:"mb-4"},e.createElement("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"}))),e.createElement("h4",{className:"text-lg font-medium text-gray-900 mb-2"},"No communities joined yet"),e.createElement("p",{className:"text-gray-600 mb-4"},"Start by exploring and joining communities that interest you!"),e.createElement(r,{to:"/communities",className:"btn-primary px-6 py-2"},"Browse Communities"))),n==="subclubs"&&e.createElement("div",{className:"space-y-4"},N.length>0?e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},N.map((t,a)=>e.createElement("div",{key:t.id,className:"glass-card rounded-xl p-6 animate-slide-up hover:shadow-lg transition-shadow",style:{animationDelay:`${a*.1}s`}},e.createElement("div",{className:"flex items-start justify-between mb-4"},e.createElement("div",{className:"flex-1"},e.createElement(r,{to:`/sub-clubs/${t.id}`,className:"text-xl font-semibold text-gray-900 hover:text-purple-600 transition-colors"},t.name),e.createElement("div",{className:"flex items-center space-x-2 mt-2"},e.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.role==="creator"?"bg-purple-100 text-purple-800":t.role==="moderator"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`},t.role==="creator"?"👑 Creator":t.role==="moderator"?"🛡️ Moderator":"👤 Member"),t.is_independent?e.createElement("span",{className:"px-2 py-1 rounded text-xs font-medium bg-orange-100 text-orange-800"},"🆓 Independent"):e.createElement("span",{className:"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800"},"🏘️ In Community")))),t.description&&e.createElement("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2"},t.description),e.createElement("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-3"},e.createElement("span",null,"👥 ",t.actual_member_count||t.member_count||0," members"),t.community_name&&e.createElement("span",null,"🏘️ ",t.community_name)),t.tags&&t.tags.length>0&&e.createElement("div",{className:"flex flex-wrap gap-1 mb-3"},t.tags.slice(0,3).map((d,s)=>e.createElement("span",{key:s,className:"px-2 py-1 bg-gray-100 text-gray-600 rounded text-xs"},"#",d)),t.tags.length>3&&e.createElement("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded text-xs"},"+",t.tags.length-3)),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("span",{className:"text-xs text-gray-400"},"Joined ",E(t.joined_at||t.user_joined_at)),e.createElement(r,{to:`/sub-clubs/${t.id}`,className:"text-purple-600 hover:text-purple-800 text-sm font-medium"},"View →"))))):e.createElement("div",{className:"glass-card rounded-xl p-8 text-center"},e.createElement("div",{className:"mb-4"},e.createElement("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"}))),e.createElement("h4",{className:"text-lg font-medium text-gray-900 mb-2"},"No sub-clubs yet"),e.createElement("p",{className:"text-gray-600 mb-4"},"Create or join sub-clubs to connect with like-minded people!"),e.createElement("div",{className:"flex justify-center space-x-3"},e.createElement(r,{to:"/create-subclub",className:"btn-primary px-6 py-2"},"Create Independent Sub-Club"),e.createElement(r,{to:"/communities",className:"btn-secondary px-6 py-2"},"Browse Communities")))),n==="activity"&&e.createElement("div",{className:"glass-card rounded-xl p-6"},e.createElement("h3",{className:"text-xl font-semibold text-gray-900 mb-4"},"Recent Activity"),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-gray-50"},e.createElement("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.createElement("div",{className:"flex-1"},e.createElement("p",{className:"text-gray-900"},"Created a new post"),e.createElement("p",{className:"text-sm text-gray-600"},"2 hours ago"))),e.createElement("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-gray-50"},e.createElement("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.createElement("div",{className:"flex-1"},e.createElement("p",{className:"text-gray-900"},"Received 10 upvotes"),e.createElement("p",{className:"text-sm text-gray-600"},"1 day ago"))),e.createElement("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-gray-50"},e.createElement("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.createElement("div",{className:"flex-1"},e.createElement("p",{className:"text-gray-900"},"Joined the community"),e.createElement("p",{className:"text-sm text-gray-600"},$))))))))};export{O as default};
