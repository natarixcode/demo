import{u as j,a as A,r as d,R as e}from"./index-C8OgQ19d.js";const P=()=>{const{user:k,getAuthHeader:w}=j(),p=A(),[a,c]=d.useState({name:"",description:"",visibility:"public",type:"agnostic",location:"",latitude:"",longitude:"",seeking_community:!1,tags:[],rules:[]}),[f,x]=d.useState(""),[E,h]=d.useState(""),[n,m]=d.useState(!1),[g,s]=d.useState(""),[N,b]=d.useState(!1);if(!k)return p("/login"),null;const o=t=>{const{name:l,value:r,type:i,checked:u}=t.target;c(y=>({...y,[l]:i==="checkbox"?u:r})),g&&s("")},v=()=>{const t=f.trim().toLowerCase();t&&!a.tags.includes(t)&&(c(l=>({...l,tags:[...l.tags,t]})),x(""))},S=t=>{c(l=>({...l,tags:l.tags.filter(r=>r!==t)}))},C=()=>{const t=E.trim();t&&!a.rules.includes(t)&&(c(l=>({...l,rules:[...l.rules,t]})),h(""))},L=t=>{c(l=>({...l,rules:l.rules.filter(r=>r!==t)}))},I=()=>{if(b(!0),!navigator.geolocation){s("Geolocation is not supported by this browser"),b(!1);return}navigator.geolocation.getCurrentPosition(async t=>{const{latitude:l,longitude:r}=t.coords;c(i=>({...i,latitude:l.toString(),longitude:r.toString()}));try{const u=await(await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${l}&longitude=${r}&localityLanguage=en`)).json();u.city&&u.countryName&&c(y=>({...y,location:`${u.city}, ${u.countryName}`}))}catch(i){console.log("Could not get location name:",i)}b(!1)},t=>{console.error("Error getting location:",t),s("Unable to get your location. Please enter it manually."),b(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})},F=async t=>{if(t.preventDefault(),m(!0),s(""),!a.name.trim()){s("Sub-club name is required"),m(!1);return}if(a.type==="location_bound"&&!a.location.trim()){s("Location is required for location-bound sub-clubs"),m(!1);return}try{const r=await(await fetch("http://localhost:3001/api/sub-clubs/independent",{method:"POST",headers:{"Content-Type":"application/json",...w()},body:JSON.stringify({...a,latitude:a.latitude?parseFloat(a.latitude):null,longitude:a.longitude?parseFloat(a.longitude):null,is_independent:!0})})).json();r.success?p(`/sub-clubs/${r.data.id}`):s(r.error||"Failed to create sub-club")}catch(l){console.error("Error creating sub-club:",l),s("Failed to create sub-club. Please try again.")}finally{m(!1)}};return e.createElement("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-6"},e.createElement("div",{className:"max-w-4xl mx-auto"},e.createElement("div",{className:"bg-white rounded-lg shadow-md p-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Create Independent Sub-Club"),e.createElement("p",{className:"text-gray-600"},"Create a sub-club that can exist independently or later join a community. Independent sub-clubs give you full control and can request to join communities later.")),g&&e.createElement("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6"},g),e.createElement("form",{onSubmit:F,className:"space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",{className:"md:col-span-2"},e.createElement("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2"},"Sub-Club Name *"),e.createElement("input",{type:"text",id:"name",name:"name",value:a.name,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Enter your sub-club name",required:!0,disabled:n})),e.createElement("div",{className:"md:col-span-2"},e.createElement("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2"},"Description"),e.createElement("textarea",{id:"description",name:"description",value:a.description,onChange:o,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Describe what your sub-club is about...",disabled:n})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Visibility *"),e.createElement("div",{className:"space-y-2"},e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"radio",name:"visibility",value:"public",checked:a.visibility==="public",onChange:o,className:"mr-2",disabled:n}),e.createElement("span",{className:"text-sm"},e.createElement("strong",null,"Public")," - Anyone can join and see content")),e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"radio",name:"visibility",value:"private",checked:a.visibility==="private",onChange:o,className:"mr-2",disabled:n}),e.createElement("span",{className:"text-sm"},e.createElement("strong",null,"Private")," - Requires approval to join")))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Type *"),e.createElement("div",{className:"space-y-2"},e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"radio",name:"type",value:"agnostic",checked:a.type==="agnostic",onChange:o,className:"mr-2",disabled:n}),e.createElement("span",{className:"text-sm"},e.createElement("strong",null,"Global")," - Open to everyone worldwide")),e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"radio",name:"type",value:"location_bound",checked:a.type==="location_bound",onChange:o,className:"mr-2",disabled:n}),e.createElement("span",{className:"text-sm"},e.createElement("strong",null,"Location-bound")," - Limited to specific location"))))),a.type==="location_bound"&&e.createElement("div",{className:"bg-blue-50 p-4 rounded-lg"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"Location Information"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",{className:"md:col-span-2"},e.createElement("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-2"},"Location *"),e.createElement("div",{className:"flex space-x-2"},e.createElement("input",{type:"text",id:"location",name:"location",value:a.location,onChange:o,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Enter location (e.g., New York, NY)",required:!0,disabled:n}),e.createElement("button",{type:"button",onClick:I,disabled:N||n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors"},N?"Getting...":"ðŸ“ Current"))),e.createElement("div",null,e.createElement("label",{htmlFor:"latitude",className:"block text-sm font-medium text-gray-700 mb-2"},"Latitude"),e.createElement("input",{type:"number",id:"latitude",name:"latitude",value:a.latitude,onChange:o,step:"any",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"40.7128",disabled:n})),e.createElement("div",null,e.createElement("label",{htmlFor:"longitude",className:"block text-sm font-medium text-gray-700 mb-2"},"Longitude"),e.createElement("input",{type:"number",id:"longitude",name:"longitude",value:a.longitude,onChange:o,step:"any",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"-74.0060",disabled:n})))),e.createElement("div",{className:"bg-green-50 p-4 rounded-lg"},e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"checkbox",name:"seeking_community",checked:a.seeking_community,onChange:o,className:"mr-3",disabled:n}),e.createElement("div",null,e.createElement("span",{className:"text-sm font-medium text-gray-900"},"Looking to join a community"),e.createElement("p",{className:"text-xs text-gray-600 mt-1"},"Check this if you'd like your sub-club to be discoverable by community admins for potential inclusion")))),e.createElement("div",null,e.createElement("label",{htmlFor:"tagInput",className:"block text-sm font-medium text-gray-700 mb-2"},"Tags"),e.createElement("div",{className:"flex space-x-2 mb-2"},e.createElement("input",{type:"text",id:"tagInput",value:f,onChange:t=>x(t.target.value),onKeyPress:t=>t.key==="Enter"&&(t.preventDefault(),v()),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Add tags (e.g., javascript, react, frontend)",disabled:n}),e.createElement("button",{type:"button",onClick:v,disabled:n,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50 transition-colors"},"Add")),a.tags.length>0&&e.createElement("div",{className:"flex flex-wrap gap-2"},a.tags.map((t,l)=>e.createElement("span",{key:l,className:"inline-flex items-center px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm"},"#",t,e.createElement("button",{type:"button",onClick:()=>S(t),disabled:n,className:"ml-2 text-purple-600 hover:text-purple-800"},"Ã—"))))),e.createElement("div",null,e.createElement("label",{htmlFor:"ruleInput",className:"block text-sm font-medium text-gray-700 mb-2"},"Rules"),e.createElement("div",{className:"flex space-x-2 mb-2"},e.createElement("input",{type:"text",id:"ruleInput",value:E,onChange:t=>h(t.target.value),onKeyPress:t=>t.key==="Enter"&&(t.preventDefault(),C()),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Add a rule for your sub-club",disabled:n}),e.createElement("button",{type:"button",onClick:C,disabled:n,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50 transition-colors"},"Add")),a.rules.length>0&&e.createElement("div",{className:"space-y-2"},a.rules.map((t,l)=>e.createElement("div",{key:l,className:"flex items-start justify-between p-3 bg-gray-50 rounded-lg"},e.createElement("span",{className:"text-sm text-gray-700"},l+1,". ",t),e.createElement("button",{type:"button",onClick:()=>L(t),disabled:n,className:"text-red-600 hover:text-red-800 ml-2"},"Ã—"))))),e.createElement("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200"},e.createElement("button",{type:"button",onClick:()=>p("/communities"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:n},"Cancel"),e.createElement("button",{type:"submit",disabled:n,className:"px-8 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},n?"Creating...":"Create Sub-Club"))))))};export{P as default};
