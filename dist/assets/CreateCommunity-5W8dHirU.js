import{u as S,a as P,r as m,R as e}from"./index-C8OgQ19d.js";const T=()=>{const{user:N,getAuthHeader:v}=S(),g=P(),[t,i]=m.useState({name:"",description:"",visibility:"public",type:"agnostic",location:"",latitude:"",longitude:"",radius_km:5,pin_code:"",tags:[]}),[p,E]=m.useState(""),[n,d]=m.useState(!1),[b,c]=m.useState(""),[x,u]=m.useState(!1),[f,y]=m.useState("");if(!N)return g("/login"),null;const o=a=>{const{name:l,value:r}=a.target;i(s=>({...s,[l]:r})),b&&c("")},h=()=>{const a=p.trim().toLowerCase();a&&!t.tags.includes(a)&&(i(l=>({...l,tags:[...l.tags,a]})),E(""))},C=()=>{if(u(!0),y(""),!navigator.geolocation){y("Geolocation is not supported by this browser"),u(!1);return}navigator.geolocation.getCurrentPosition(async a=>{const{latitude:l,longitude:r}=a.coords;i(s=>({...s,latitude:l.toString(),longitude:r.toString()}));try{const s=`Lat: ${l.toFixed(4)}, Lng: ${r.toFixed(4)}`;i(_=>({..._,location:s}))}catch(s){console.error("Error getting location name:",s)}u(!1)},a=>{console.error("Error getting location:",a),y("Unable to get your location. Please enter manually."),u(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},k=a=>{const l=parseInt(a.target.value);i(r=>({...r,radius_km:l}))},w=a=>{i(l=>({...l,tags:l.tags.filter(r=>r!==a)}))},L=a=>{a.key==="Enter"&&(a.preventDefault(),h())},F=async a=>{if(a.preventDefault(),d(!0),c(""),!t.name.trim()){c("Community name is required"),d(!1);return}if(t.type==="location_bound"&&!t.location.trim()){c("Location is required for location-bound communities"),d(!1);return}try{const r=await(await fetch("http://localhost:3001/api/communities",{method:"POST",headers:{"Content-Type":"application/json",...v()},body:JSON.stringify({...t,latitude:t.latitude?parseFloat(t.latitude):null,longitude:t.longitude?parseFloat(t.longitude):null})})).json();r.success?g(`/communities/${r.data.id}`):c(r.error||"Failed to create community")}catch(l){console.error("Error creating community:",l),c("Failed to create community. Please try again.")}finally{d(!1)}};return e.createElement("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-6"},e.createElement("div",{className:"max-w-2xl mx-auto"},e.createElement("div",{className:"bg-white rounded-lg shadow-md p-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-8"},"Create New Community"),b&&e.createElement("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6"},b),e.createElement("form",{onSubmit:F,className:"space-y-6"},e.createElement("div",null,e.createElement("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2"},"Community Name *"),e.createElement("input",{type:"text",id:"name",name:"name",value:t.name,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter community name",required:!0,disabled:n})),e.createElement("div",null,e.createElement("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2"},"Description"),e.createElement("textarea",{id:"description",name:"description",value:t.description,onChange:o,rows:"4",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Describe your community...",disabled:n})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Visibility *"),e.createElement("div",{className:"space-y-2"},e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"radio",name:"visibility",value:"public",checked:t.visibility==="public",onChange:o,className:"mr-2",disabled:n}),e.createElement("span",{className:"text-sm"},e.createElement("strong",null,"Public")," - Anyone can join immediately")),e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"radio",name:"visibility",value:"private",checked:t.visibility==="private",onChange:o,className:"mr-2",disabled:n}),e.createElement("span",{className:"text-sm"},e.createElement("strong",null,"Private")," - Requires approval to join")))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Community Type *"),e.createElement("div",{className:"space-y-2"},e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"radio",name:"type",value:"agnostic",checked:t.type==="agnostic",onChange:o,className:"mr-2",disabled:n}),e.createElement("span",{className:"text-sm"},e.createElement("strong",null,"Location Agnostic")," - Open to members from anywhere")),e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"radio",name:"type",value:"location_bound",checked:t.type==="location_bound",onChange:o,className:"mr-2",disabled:n}),e.createElement("span",{className:"text-sm"},e.createElement("strong",null,"Location Bound")," - Tied to a specific location")))),t.type==="location_bound"&&e.createElement("div",{className:"space-y-4 p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-blue-200"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"},e.createElement("span",{className:"text-white text-sm"},"📍")),e.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Location Settings")),e.createElement("div",null,e.createElement("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-2"},"Location Name *"),e.createElement("input",{type:"text",id:"location",name:"location",value:t.location,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Bidholi, Dehradun",required:t.type==="location_bound",disabled:n})),e.createElement("div",null,e.createElement("label",{htmlFor:"pin_code",className:"block text-sm font-medium text-gray-700 mb-2"},"PIN Code (Optional)"),e.createElement("input",{type:"text",id:"pin_code",name:"pin_code",value:t.pin_code,onChange:o,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 248007",maxLength:"10",disabled:n})),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{htmlFor:"latitude",className:"block text-sm font-medium text-gray-700 mb-2"},"Latitude"),e.createElement("input",{type:"number",id:"latitude",name:"latitude",value:t.latitude,onChange:o,step:"any",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"30.2849",disabled:n})),e.createElement("div",null,e.createElement("label",{htmlFor:"longitude",className:"block text-sm font-medium text-gray-700 mb-2"},"Longitude"),e.createElement("input",{type:"number",id:"longitude",name:"longitude",value:t.longitude,onChange:o,step:"any",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"78.0422",disabled:n}))),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("button",{type:"button",onClick:C,className:"flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",disabled:n||x},x?e.createElement(e.Fragment,null,e.createElement("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.createElement("span",null,"Getting Location...")):e.createElement(e.Fragment,null,e.createElement("span",null,"📍"),e.createElement("span",null,"Use My Current Location"))),f&&e.createElement("span",{className:"text-red-600 text-sm"},f)),e.createElement("div",null,e.createElement("label",{htmlFor:"radius",className:"block text-sm font-medium text-gray-700 mb-2"},"Community Radius: ",e.createElement("span",{className:"font-bold text-blue-600"},t.radius_km," km")),e.createElement("div",{className:"space-y-2"},e.createElement("input",{type:"range",id:"radius",min:"1",max:"50",value:t.radius_km,onChange:k,className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider",disabled:n}),e.createElement("div",{className:"flex justify-between text-xs text-gray-500"},e.createElement("span",null,"1 km"),e.createElement("span",null,"25 km"),e.createElement("span",null,"50 km")),e.createElement("p",{className:"text-sm text-gray-600"},"Only users within ",t.radius_km," km of this location can join the community"))),t.latitude&&t.longitude&&e.createElement("div",{className:"bg-white p-3 rounded-lg border border-gray-200"},e.createElement("h4",{className:"text-sm font-medium text-gray-700 mb-2"},"📍 Location Preview"),e.createElement("div",{className:"text-sm text-gray-600 space-y-1"},e.createElement("p",null,e.createElement("strong",null,"Location:")," ",t.location),t.pin_code&&e.createElement("p",null,e.createElement("strong",null,"PIN:")," ",t.pin_code),e.createElement("p",null,e.createElement("strong",null,"Coordinates:")," ",parseFloat(t.latitude).toFixed(4),", ",parseFloat(t.longitude).toFixed(4)),e.createElement("p",null,e.createElement("strong",null,"Radius:")," ",t.radius_km," km")))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tags (Optional)"),e.createElement("div",{className:"flex flex-wrap gap-2 mb-2"},t.tags.map((a,l)=>e.createElement("span",{key:l,className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm flex items-center"},a,e.createElement("button",{type:"button",onClick:()=>w(a),className:"ml-2 text-blue-600 hover:text-blue-800",disabled:n},"×")))),e.createElement("div",{className:"flex gap-2"},e.createElement("input",{type:"text",value:p,onChange:a=>E(a.target.value),onKeyPress:L,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Add a tag...",disabled:n}),e.createElement("button",{type:"button",onClick:h,className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",disabled:n||!p.trim()},"Add"))),e.createElement("div",{className:"flex gap-4 pt-6"},e.createElement("button",{type:"submit",disabled:n,className:"flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium"},n?"Creating...":"Create Community"),e.createElement("button",{type:"button",onClick:()=>g("/communities"),className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:n},"Cancel"))))))};export{T as default};
