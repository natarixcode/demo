import{u as v,a as y,c as w,r as i,R as e}from"./index-C8OgQ19d.js";const C=()=>{const{user:d,getAuthHeader:p}=v(),c=y(),{subClubId:s}=w(),[l,h]=i.useState(null),[t,x]=i.useState({title:"",content:""}),[b,u]=i.useState(!1),[n,a]=i.useState("");if(!d)return c("/login"),null;i.useEffect(()=>{f()},[s]);const f=async()=>{try{const r=await(await fetch(`http://localhost:5000/api/subclubs/${s}`,{headers:{"Content-Type":"application/json",...p()}})).json();r.success?(h(r.data),r.data.user_role||a("You must be a member of the sub-club to create posts")):a(r.error||"Sub-club not found")}catch(o){console.error("Error fetching sub-club:",o),a("Failed to load sub-club")}},g=o=>{const{name:r,value:m}=o.target;x(N=>({...N,[r]:m})),n&&a("")},E=async o=>{if(o.preventDefault(),u(!0),a(""),!t.title.trim()){a("Post title is required"),u(!1);return}if(!t.content.trim()){a("Post content is required"),u(!1);return}try{const m=await(await fetch("http://localhost:5000/api/posts",{method:"POST",headers:{"Content-Type":"application/json",...p()},body:JSON.stringify({title:t.title.trim(),content:t.content.trim(),author:d.id,sub_club_id:parseInt(s),is_draft:!1})})).json();m.success||m.data?c(`/subclubs/${s}`):a(m.error||"Failed to create post")}catch(r){console.error("Error creating post:",r),a("Failed to create post. Please try again.")}finally{u(!1)}};return!l&&!n?e.createElement("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),e.createElement("p",{className:"text-gray-600 mt-4"},"Loading sub-club..."))):n?e.createElement("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 flex items-center justify-center px-4"},e.createElement("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center"},e.createElement("div",{className:"text-red-500 text-5xl mb-4"},"‚ö†Ô∏è"),e.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Error"),e.createElement("p",{className:"text-gray-600 mb-6"},n),e.createElement("button",{onClick:()=>c("/communities"),className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors"},"Back to Communities"))):e.createElement("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 py-8"},e.createElement("div",{className:"container mx-auto px-4 max-w-4xl"},e.createElement("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6"},e.createElement("div",{className:"flex items-center justify-between mb-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Create Post"),e.createElement("p",{className:"text-gray-600 mt-1"},"Share something with ",e.createElement("span",{className:"font-semibold text-purple-600"},l==null?void 0:l.name))),e.createElement("button",{onClick:()=>c(`/subclubs/${s}`),className:"text-gray-500 hover:text-gray-700 transition-colors"},e.createElement("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})))),l&&e.createElement("div",{className:"bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg p-4"},e.createElement("div",{className:"flex items-center text-sm text-gray-700"},e.createElement("svg",{className:"w-4 h-4 mr-2 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})),e.createElement("span",{className:"font-medium"},"Posting to:"),e.createElement("span",{className:"ml-1 font-semibold text-purple-700"},l.name),l.community_name&&e.createElement(e.Fragment,null,e.createElement("span",{className:"mx-2"},"‚Ä¢"),e.createElement("span",null,"in ",l.community_name))))),e.createElement("div",{className:"bg-white rounded-lg shadow-lg p-6"},e.createElement("form",{onSubmit:E,className:"space-y-6"},e.createElement("div",null,e.createElement("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2"},"Post Title ",e.createElement("span",{className:"text-red-500"},"*")),e.createElement("input",{type:"text",id:"title",name:"title",value:t.title,onChange:g,placeholder:"What's your post about?",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",maxLength:255,required:!0}),e.createElement("div",{className:"text-xs text-gray-500 mt-1"},t.title.length,"/255 characters")),e.createElement("div",null,e.createElement("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-2"},"Post Content ",e.createElement("span",{className:"text-red-500"},"*")),e.createElement("textarea",{id:"content",name:"content",value:t.content,onChange:g,placeholder:"Share your thoughts, ideas, or experiences...",rows:10,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200 resize-vertical",required:!0}),e.createElement("div",{className:"text-xs text-gray-500 mt-1"},t.content.length," characters")),n&&e.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4"},e.createElement("div",{className:"flex"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},e.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))),e.createElement("div",{className:"ml-3"},e.createElement("p",{className:"text-sm text-red-700"},n)))),e.createElement("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200"},e.createElement("button",{type:"button",onClick:()=>c(`/subclubs/${s}`),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"},"Cancel"),e.createElement("div",{className:"flex gap-3"},e.createElement("button",{type:"submit",disabled:b||!t.title.trim()||!t.content.trim(),className:"px-8 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors inline-flex items-center"},b?e.createElement(e.Fragment,null,e.createElement("svg",{className:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},e.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),"Creating Post..."):e.createElement(e.Fragment,null,e.createElement("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})),"Publish Post")))))),e.createElement("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-6 mt-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-3"},"üìù Posting Guidelines"),e.createElement("ul",{className:"space-y-2 text-sm text-gray-700"},e.createElement("li",{className:"flex items-start"},e.createElement("span",{className:"text-purple-600 mr-2"},"‚Ä¢"),"Make sure your post is relevant to the sub-club topic"),e.createElement("li",{className:"flex items-start"},e.createElement("span",{className:"text-purple-600 mr-2"},"‚Ä¢"),"Be respectful and constructive in your discussions"),e.createElement("li",{className:"flex items-start"},e.createElement("span",{className:"text-purple-600 mr-2"},"‚Ä¢"),"Use clear and descriptive titles"),e.createElement("li",{className:"flex items-start"},e.createElement("span",{className:"text-purple-600 mr-2"},"‚Ä¢"),"Follow the sub-club and community rules")))))};export{C as default};
